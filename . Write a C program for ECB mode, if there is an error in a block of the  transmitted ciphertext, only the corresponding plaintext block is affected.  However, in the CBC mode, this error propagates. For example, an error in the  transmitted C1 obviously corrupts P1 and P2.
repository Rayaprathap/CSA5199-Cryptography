#include <stdio.h>
#include <string.h>

void ecb_encrypt(const unsigned char *plaintext, unsigned char *ciphertext, const unsigned char *key) {
    for (int i = 0; i < 8; i++) {
        ciphertext[i] = plaintext[i] ^ key[i];
    }
}

void ecb_decrypt(const unsigned char *ciphertext, unsigned char *plaintext, const unsigned char *key) {
    for (int i = 0; i < 8; i++) {
        plaintext[i] = ciphertext[i] ^ key[i];
    }
}

int main() {
    unsigned char key[8] = "123";
    unsigned char plaintext[8] = "1234";
    unsigned char ciphertext[8];
    unsigned char decrypted[8];

    // Encrypt in ECB mode
    ecb_encrypt(plaintext, ciphertext, key);

    printf("Plaintext: %s\n", plaintext);
    printf("Ciphertext: ");
    for (int i = 0; i < 8; i++) {
        printf("%02X", ciphertext[i]);
    }
    printf("\n");

    // Decrypt the ciphertext
    ecb_decrypt(ciphertext, decrypted, key);

    printf("Decrypted: %s\n", decrypted);

    return 0;
}

